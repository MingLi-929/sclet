[["index.html", "sclet: A Lightweight Toolkit for Single-Cell Data Analysis Preface", " sclet: A Lightweight Toolkit for Single-Cell Data Analysis Guangchuang Yu Department of Bioinformatics, School of Basic Medical Sciences, Southern Medical University guangchuangyu@gmail.com 2024-10-01 Preface Hello World. "],["seurat-like-functions.html", "1 Seurat-like functions 1.1 Read 10X data 1.2 QC 1.3 Variable features 1.4 Dimensional reduction 1.5 Clustering 1.6 UMAP 1.7 Cell cluster annotation", " 1 Seurat-like functions 1.1 Read 10X data library(sclet) dir &lt;- &quot;filtered_gene_bc_matrices/hg19&quot; sce &lt;- Read10X(dir) 1.2 QC # colData(sce)$percent.mt &lt;- PercentageFeatureSet(sce, &quot;^MT-&quot;) sce[[&quot;percent.mt&quot;]] &lt;- PercentageFeatureSet(sce, &quot;^MT-&quot;) VlnPlot(sce, features = c(&quot;nFeature_RNA&quot;, &quot;nCount_RNA&quot;, &quot;percent.mt&quot;)) subset_feature(sce, 10) ## ************************************************** &gt;=0 | 32738 (100%) ## ************************* &gt;=1 | 16634 (51%) ## ********************** &gt;=2 | 14702 (45%) ## ********************* &gt;=3 | 13714 (42%) ## ******************** &gt;=4 | 13034 (40%) ## ******************* &gt;=5 | 12572 (38%) ## ******************* &gt;=6 | 12198 (37%) ## ****************** &gt;=7 | 11876 (36%) ## ****************** &gt;=8 | 11627 (36%) ## ***************** &gt;=9 | 11379 (35%) ## ***************** &gt;=10 | 11139 (34%) sce &lt;- subset_feature(sce, mincell = 3, peek=FALSE) sce &lt;- subset(sce, subset = nFeature_RNA &gt; 200 &amp; nFeature_RNA &lt; 2500 &amp; percent.mt &lt; 5) sce ## class: SingleCellExperiment ## dim: 13714 2638 ## metadata(1): Samples ## assays(1): counts ## rownames(13714): AL627309.1 AP006222.2 ... ## PNRC2_ENSG00000215700 SRSF10_ENSG00000215699 ## rowData names(2): ID Symbol ## colnames: NULL ## colData names(5): Sample Barcode nFeature_RNA ## nCount_RNA percent.mt ## reducedDimNames(0): ## mainExpName: NULL ## altExpNames(0): plot1 &lt;- FeatureScatter(sce, feature1 = &quot;nCount_RNA&quot;, feature2 = &quot;percent.mt&quot;) plot2 &lt;- FeatureScatter(sce, feature1 = &quot;nCount_RNA&quot;, feature2 = &quot;nFeature_RNA&quot;) library(aplot) plot_list(plot1, plot2) Users can also use plotColData() to visualize the QC data. # VlnPlot-like p1 &lt;- plotColData(sce, y = &#39;nCount_RNA&#39;) # FeatureScatter-like p2 &lt;- plotColData(sce, x = &quot;nCount_RNA&quot;, y = &quot;percent.mt&quot;) plot_list(p1, p2) 1.3 Variable features sce &lt;- NormalizeData(sce) sce &lt;- FindVariableFeatures(sce) top10 &lt;- head(VariableFeatures(sce), 10) top10 ## [1] &quot;PPBP&quot; &quot;LYZ&quot; &quot;S100A9&quot; &quot;IGLL5&quot; &quot;GNLY&quot; &quot;FTL&quot; ## [7] &quot;PF4&quot; &quot;FTH1&quot; &quot;GNG11&quot; &quot;S100A8&quot; VariableFeaturePlot(sce, label = top10) 1.4 Dimensional reduction sce &lt;- ScaleData(sce) sce &lt;- runPCA(sce, subset_row = VariableFeatures(sce), exprs_values = &quot;scaled&quot;) ElbowPlot(sce) 1.5 Clustering set.seed(2024-10-01) sce &lt;- FindNeighbors(sce, dims = 1:10) sce &lt;- FindClusters(sce) head(Idents(sce), 5) ## AAACATACAACCAC-1 AAACATTGAGCTAC-1 AAACATTGATCAGC-1 ## 1 2 3 ## AAACCGTGCTTCCG-1 AAACCGTGTATGCG-1 ## 4 5 ## Levels: 1 2 3 4 5 6 7 8 9 1.6 UMAP sce &lt;- RunUMAP(sce, 1:10) library(ggsc) library(aplot) p1 &lt;- sc_dim(sce, reduction=&quot;PCA&quot;) p2 &lt;- sc_dim(sce, reduction=&quot;UMAP&quot;) plot_list(gglist = list(PCA=p1, UMAP=p2)) 1.7 Cell cluster annotation new_labels &lt;- c(&quot;CD8+ T&quot;,&quot;B&quot;,&quot;Memory CD4+&quot;,&quot;CD14+ Mono&quot;, &quot;NK&quot;,&quot;FCGR3A+ Mono&quot;,&quot;Native CD4+ T&quot;,&quot;DC&quot;,&quot;Platelet&quot;) sce &lt;- RenameIdents(sce, new_labels) sc_dim(sce, reduction=&quot;UMAP&quot;) + sc_dim_geom_label() "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
